<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
  </head>
  <body>
  <button id="new_tweets"> New tweets? </button>
    <script>
      $("#new_tweets").on("click", updateTweets);

      var first_undisplayed = 0;

      $(document).ready(function(){
        var $body = $('body');
        // $body.html('');

        // var index = streams.home.length - 1;
        // while(index >= 0){
        //   var tweet = streams.home[index];
        //   var $tweet = $('<div></div>');
        //   $tweet.text('@' + tweet.user + ': ' + tweet.message + "             - tweeted @ " + tweet.created_at);
        //   $tweet.appendTo($body);
        //   index -= 1;
        // }

        updateTweets();

        $('.link').on('click', function(){
          var username = this.text.slice(1, this.text.length - 2);
          $body.html('');

          for(var x in streams.users){
            if(username == x){
              console.log(streams.users[x]);

              //streams.users[x] looks like: [Object, Object];
              //

              for(var y = 0; y < streams.users[x].length; y++){
                  var $tweet2 = $('<div></div>');
                  console.log(streams.users[x][y]["message"]);
                  $tweet2.text('@' + username + ': ' + streams.users[x][y]["message"] + "             - tweeted @ " + streams.users[x][y]["created_at"]);
                  $tweet2.appendTo($body);
              }

            }
          }



        })

        


      });

      function updateTweets(){
            
            // console.log(streams.home.length);
            // console.log(streams.home);

            for(var x = streams.home.length - 1; x >= first_undisplayed; x--){
                var tweet = streams.home[x];
                var $tweet = $('<div></div>');
                var $link = $("<a href='#'>" + "@" + tweet.user + ": " + "</a>");
                $link.addClass("link");
                $tweet.text(tweet.message + " - tweeted @ " + tweet.created_at);
                $tweet.prepend($link);
                $tweet.appendTo($('body'));
            }

            first_undisplayed = streams.home.length;

        }

      
    </script>
    
  </body>
</html>
